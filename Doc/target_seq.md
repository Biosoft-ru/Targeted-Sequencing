# Сценарий "Секвенирование целевых локусов"

Сценарий "Секвенирование целевых локусов" предназначен для реконструкции и анализа целевых локусов на основе данных таргетного мономолекулярного секвенирования (рисунок 1).

![](RackMultipart20221216-1-tbviau_html_eb4c26ce4432b6a7.png)

Рисунок 1 – Схема сценария "Секвенирование целевых локусов" на платформе BioUML

Рассматриваемый сценарий состоит из 8 основных шагов (см. Таблица 1). Краткое описание используемых программ, их входных и выходных параметров приведено в таблице 2.1.

Таблица 1 – Список шагов сценария "Секвенирование целевых локусов"

| № | Описание шага | Используемые программы |
| --- | --- | --- |
| 1 | Определение и удаление молекулярных "штрих-кодов" и удаление 5'- 3'-концевых праймеров, демультиплексирование прочтений | lima |
| 2 | Идентификация и удаление ПЦР-дубликатов на основании кластеризации данных по баркодам и UMI | pbmarkdup |
| 3 | Выравнивание прочтений на референсный геном | pbmm2 |
| 4 | Идентификация однонуклеотидных полиморфизмов | deepvariant |
| 5 | Идентификация структурных вариаций | pbsv |
| 6 | Фазирование идентифицированных полиморфизмов | whatshap phase |
| 7 | Анализ структурного контекста сайтов модификации. Внесение информации о принадлежности к гаплогруппе в bam-файл с выравниванием CCS ридов на референсный геном | whatshap haplotag |
| 8 | Оценка качества гибридизации для отбора таргетных локусов и сбор статистики по данным районам | CollectHsMetrics из пакета Picard |
| 9 | Создание отчета на основе данных из CollectHsMetrics | multiQC |

В таблице 2 приведены типы входных и выходных данных рассматриваемого сценария. Интерфейс пользователя, а также параметры запуска сценария приведены в примере ниже.

Таблица 2 – Список входных данных и результатов использования сценария "Секвенирование целевых локусов"

| Тип данных | Формат данных |
| --- | --- |
| _Входные данные_ |
| Данные одномолекулярного секвенирования: консенсусные прочтения | BAM |
| Референсный геном | FASTA |
| _Результаты_ |
| Результаты выравнивания консенсусных прочтений на референсный геном с дополнительной информацией о принадлежности прочтений к гаплогруппам | BAM |
| Однонуклеотидные полиморфизмы | VCF |
| Структурные вариации | VCF |
| Отчёты о качестве и результатах анализа данных таргетного секвенирования | HTML |
| Отчёты о результатах поиска однонуклеотидных полиморфизмов | HTML |

Используемые референсные базы данных: см. пункт 2.1.

### **Пример использования "Секвенирование целевых локусов"**

Сценарий предназначен для реконструкции и анализа целевых локусов на основе данных таргетного мономолекулярного секвенирования (рисунок 2). Данный сценарий решает задачи сценария, описанного в пункте 2.5 приложения №2 ТЗ.

![](RackMultipart20221216-1-tbviau_html_93703644e1d5a0c9.png)

Рисунок 2 – Интерфейс запуска сценария "Секвенирование целевых локусов"

В проекте "Sequencer examples" перейдите в директорию "Targeted Sequencing". Для просмотра структуры сценария в графическом виде кликните правой кнопкой мыши на WDL-сценарий "Targeted\_sequencing\_workflow.wdl". В открывшемся меню выберите пункт "Open image". Результат представлен на рисунке 3.

![](RackMultipart20221216-1-tbviau_html_963ceb9b7c301910.png)

Рисунок 3 – Графическое представление структуры сценария "Секвенирование целевых локусов"

Заполните параметры запуска сценария, используя значения из таблицы 3. В результате работы сценария будут получены выходные данные, также указанные в таблице 3 (Выходные данные).

Таблица 3 – Параметры сценария "Секвенирование целевых локусов"

| **Параметр** | **Формат** | **Значение\*** | **Краткое описание** |
| --- | --- | --- | --- |
| _Входные данные и параметры_ |
| targeted\_sequencing.bam | BAM | Input/test\_data.chr1.bam | Данные одномолекулярного секвенирования: консенсусные прочтения |
| targeted\_sequencing.ref\_fasta | FASTA | Input/human\_GRCh38\_no\_alt\_analysis\_set.fasta | Референсный геном |
| targeted\_sequencing.region\_fasta | FASTA | Input/chr1.fa | Таргетная последовательность |
| targeted\_sequencing.primers\_fasta | FASTA | Input/Twist\_Universal\_Adapter\_System\_384.fasta | Последовательность праймера |
| targeted\_sequencing.tr\_bed | BED | Input/hg38.trf.bed | Тандемные повторы |
| targeted\_sequencing.lima\_bool | Логический | False | Указывает надо ли проводить анализ lima |
| targeted\_sequencing.gene\_bed | BED | Input/CACNA1S.bed | Bed файл таргетного гена |
| targeted\_sequencing.regions\_pbsv | Набор строк | chr1 | Наименования хромосом для поиска вариаций |
| targeted\_sequencing.regions\_deepvariant | Строка (разделитель - ,) | chr1 | Наименования хромосом для поиска вариаций |
| targeted\_sequencing.bait\_bed | BED | Input/chr1.bed | Bed файл для таргетного региона |
| outFolder | Папка | Results | Путь до директории с результатами |
|
| _Выходные данные_ |
| | BAM | Results/pbmarkdup\_out.hg38.bam | Результаты выравнивания консенсусных прочтений на референсный геном с дополнительной информацией о принадлежности прочтений к гаплогруппам |
| | VCF | Results/deepvariant\_snp.vcf | Однонуклеотидные полиморфизмы |
| | VCF | Results/pbsv\_vcf.vcf | Структурные вариации |
| | HTML | Results/multiqc\_report.html | Отчёт о качестве и результатах анализа данных таргетного секвенирования |
| | HTML | Results/pbmarkdup\_out.hg38.visual\_report.html | Отчёты о результатах поиска однонуклеотидных полиморфизмов

\* - указан путь относительно директории data/Collaboration/Sequencer examples/Targeted Sequencing